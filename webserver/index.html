
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>ENEA BOX</title>
        
<!-- 

Sentra Template

https://templatemo.com/tm-518-sentra

-->
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="apple-touch-icon" href="apple-touch-icon.png">

        <link rel="stylesheet" href="css/bootstrap.min.css">
        <link rel="stylesheet" href="css/bootstrap-theme.min.css">
        <link rel="stylesheet" href="css/fontAwesome.css">
        <link rel="stylesheet" href="css/light-box.css">
        <link rel="stylesheet" href="css/owl-carousel.css">
        <link rel="stylesheet" href="css/templatemo-style.css">

        <script src="js/vendor/modernizr-2.8.3-respond-1.4.2.min.js"></script>
    </head>

<body>



        <header class="nav-down responsive-nav hidden-lg hidden-md">
            <button type="button" id="nav-toggle" class="navbar-toggle" data-toggle="collapse" data-target="#main-nav">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <!--/.navbar-header-->
            <div id="main-nav" class="collapse navbar-collapse">
                <nav>
                    <ul class="nav navbar-nav">
                        <li><a href="#top">Home</a></li>
                        <li><a href="#featured">Features</a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <div class="sidebar-navigation hidde-sm hidden-xs">
            <div class="logo">
                <a>ANTARCTIC BOX</a>
            </div>
            <nav>
                <ul>
                    <li>
                        <a href="#top">
                            <span class="rect"></span>
                            <span class="circle"></span>
                            Home
                        </a>
                    </li>
                    <li>
                        <a href="#featured">
                            <span class="rect"></span>
                            <span class="circle"></span>
                            Features
                        </a>
                    </li>
                </ul>
            </nav>
        </div>

        <div class="page-content">
            <div class="Modern-Slider content-section" id="top">
                <!-- Item -->
                <div class="item item-1">
                    <div class="img-fill">
                    <div class="image"></div>
                    <div class="info">
                        <div>
                          <h1>Command Template</h1>
                          <p>This template allows user to check BOX state and to configure satellite timings.<br>
                          	Click for showing BOX features.</p>
                          <div class="white-button button">
                              <a href="#featured">Discover More</a>
                          </div>
                        </div>
                        </div>
                    </div>
                </div>
                <!-- // Item -->
            </div>
        </div>


        <div class="page-content">
            <section id="featured" class="content-section">
                <div class="section-heading">
                    <h1><em>State</em></h1>
                </div>
                <div class="section-content">
                    <div class="owl-carousel owl-theme">
                        <div class="item">
                            <div class="text-content">
                                <h4>Iridium SBD <button id="irstate" class="btn mt-3 w-100"></button></h4><br>

				<p style="font-family:'Helvetica'; font-size:100%; margin-bottom:1px;">IMEI:          <span style="font-family:'Helvetica'; float:center;"  id="imei"></span></p>
                             	<p style="font-family:'Helvetica'; font-size:100%; margin-bottom:1px;">MO time (minutes):   <span style="font-family:'Helvetica'; float:center;"  id="moget"></span></p>
				<p style="font-family:'Helvetica'; font-size:100%; margin-bottom:1px;">MT time (minutes):   <span style="font-family:'Helvetica'; float:center;"  id="mtget"></span></p>
                            </div>

                        </div>

                        <div class="item">
                            <div class="text-content">
                                <h4>ADC <button id="adcstate" class="btn mt-3 w-100"></button></h4><br>

				<p style="font-family:'Helvetica'; font-size:90%; margin-bottom:5px;">MULTIP:         <span style="font-family:'Helvetica'; float:center;"  id="m"></span></p>
				<p style="font-family:'Helvetica'; font-size:90%; margin-bottom:5px;">ADC1:         <span style="font-family:'Helvetica'; float:center;"  id="a1"></span></p>
                                <p style="font-family:'Helvetica'; font-size:90%; margin-bottom:5px;">ADC2:         <span style="font-family:'Helvetica'; float:center;"  id="a2"></span></p>
                                <p style="font-family:'Helvetica'; font-size:90%; margin-bottom:5px;">ADC3:         <span style="font-family:'Helvetica'; float:center;"  id="a3"></span></p>
                                <p style="font-family:'Helvetica'; font-size:90%; margin-bottom:5px;">ADC4:         <span style="font-family:'Helvetica'; float:center;"  id="a4"></span></p>
                                <p style="font-family:'Helvetica'; font-size:90%; margin-bottom:5px;">ADC5:         <span style="font-family:'Helvetica'; float:center;"  id="a5"></span></p>
                                <p style="font-family:'Helvetica'; font-size:90%; margin-bottom:5px;">ADC6:         <span style="font-family:'Helvetica'; float:center"  id="a6"></span></p>
                                <p style="font-family:'Helvetica'; font-size:90%; margin-bottom:5px;">ADC7:         <span style="font-family:'Helvetica'; float:center;"  id="a7"></span></p>
                                <p style="font-family:'Helvetica'; font-size:90%; margin-bottom:5px;">ADC8:         <span style="font-family:'Helvetica'; float:center;"  id="a8"></span></p>
                            </div>
                        </div>

                        <div class="item">
                            <div class="text-content">
				<h4>GPIO <button id="gpiostate" class="btn mt-3 w-100"></button></h4><br>

				<p style="font-family:'Helvetica'; font-size:90%; margin-bottom:5px;">GPIO1:         <span style="font-family:'Helvetica'; float:center;"  id="g1"></span></p>
                                <p style="font-family:'Helvetica'; font-size:90%; margin-bottom:5px;">GPIO2:         <span style="font-family:'Helvetica'; float:center;"  id="g2"></span></p>
                                <p style="font-family:'Helvetica'; font-size:90%; margin-bottom:5px;">GPIO3:         <span style="font-family:'Helvetica'; float:center;"  id="g3"></span></p>
                                <p style="font-family:'Helvetica'; font-size:90%; margin-bottom:5px;">GPIO4:         <span style="font-family:'Helvetica'; float:center;"  id="g4"></span></p>
                                <p style="font-family:'Helvetica'; font-size:90%; margin-bottom:5px;">GPIO5:         <span style="font-family:'Helvetica'; float:center;"  id="g5"></span></p>
                                <p style="font-family:'Helvetica'; font-size:90%; margin-bottom:5px;">GPIO6:         <span style="font-family:'Helvetica'; float:center;"  id="g6"></span></p>
                                <p style="font-family:'Helvetica'; font-size:90%; margin-bottom:5px;">GPIO7:         <span style="font-family:'Helvetica'; float:center;"  id="g7"></span></p>
                                <p style="font-family:'Helvetica'; font-size:90%; margin-bottom:5px;">GPIO8:         <span style="font-family:'Helvetica'; float:center;"  id="g8"></span></p>
                            </div>
                        </div>

			<div class="item">
                            <div class="text-content">
                                <h4>BOX <button id="boxstate" class="btn mt-3 w-100"></button></h4><br>

                                <p style="font-family:'Helvetica'; font-size:90%; margin-bottom:5px;">Temperature Â°:    <span style="font-family:'Helvetica'; float:center;"  id="temp"></span></p>
                                <p style="font-family:'Helvetica'; font-size:90%; margin-bottom:5px;">Disk free %:      <span style="font-family:'Helvetica'; float:center;"  id="sd"></span></p>
				<p style="font-family:'Helvetica'; font-size:90%; margin-bottom:5px;">Date:       	<span style="font-family:'Helvetica'; float:center;"  id="date"></span></p>
                            </div>
                        </div>

                    </div>
                </div>

  <div>&nbsp;</div>
  <div>&nbsp;</div>
  <div>&nbsp;</div>
  <div>&nbsp;</div>

		<div class="section-heading">
                    <h1><em>Commands</em></h1>
                </div>
		<div class="section-content">
                    <div class="owl-carousel owl-theme">

			<div class="item">
                            <form>
                                    <div class="form-group">
                                      <div class="col-xs-4">
                                        <label for="momt">Satellite</label>

					  <select name="momt" id="momt">
                                                <option value="sampleMO">MO</option>
                                                <option value="sampleMT">MT</option>
					  </select>

                                        <div>&nbsp;</div>
                                        <label for="time">Time (minutes)</label>
                                        <input id="time" type="number" step="1" min="0" max="1000" class="form-control">
                                      </div>
                                    </div>
                            </form>
                        <br><br><button id="sat_go" class="btn btn-success mt-3 w-100">SET</button>
                        </div>


			<div class="item">
                            <form>
                                    <div class="form-group">
                                      <div class="col-xs-4">
                                        <label for="momt">ADC MULTIP</label>
                                        <div>&nbsp;</div>
                                        <label for="vadc">Value</label>
                                        <input id="vadc" type="number" step="any" class="form-control">
                                      </div>
                                    </div>
                            </form>
                        <br><br><button id="adc_go" class="btn btn-success mt-3 w-100">SET</button>
                        </div>


                        <div class="item">
                            <form>
                                    <div class="form-group">
				      <div class="col-xs-4">
                                        <label for="gpioo">GPIO</label>
					&nbsp;&nbsp;<select name="gpioo" id="gpioo">
                                                <option value="1">1</option>
                                                <option value="2">2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5</option>
						<option value="6">6</option>
						<option value="7">7</option>
						<option value="8">8</option>
                                        </select>
					<div>&nbsp;</div>
					<label for="status">Value</label>
					&nbsp;&nbsp;<select name="status" id="status">
                                                <option value="1">ON</option>
                                                <option value="0">OFF</option>
                                        </select>
				      </div>
                                    </div>
                            </form>
			<br><br><button id="gpio_go" class="btn btn-success mt-3 w-100">SET</button>
                        </div>


			<div class="item">
  				<label for="systime">System time (UTC):</label><br>
  				<input type="datetime-local" id="systime" name="systime">
				<button id="time_go" class="btn btn-success mt-3 w-100">SET</button>
                        </div>


			<div class="item">
				<button id="reboot" class="btn btn-warning mt-3 w-100">REBOOT</button><br><br>
				<button id="shutdown" class="btn btn-danger mt-3 w-100">SHUTDOWN</button>
                        </div>
		</div>
		

            </section>

            <section class="footer">
                <p>Copyright &copy; 2021 ADPM Drones - Telespazio </p>
            </section>
        </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.11.2.min.js"><\/script>')</script>

    <script src="js/vendor/bootstrap.min.js"></script>
    
    <script src="js/plugins.js"></script>
    <script src="js/main.js"></script>

    <script>
        // Hide Header on on scroll down
        var didScroll;
        var lastScrollTop = 0;
        var delta = 5;
        var navbarHeight = $('header').outerHeight();

	var url = "http://boxtelespazio:5000/box"
	document.getElementById("m").innerHTML = 1;
	document.getElementById("a1").innerHTML = 0;
        document.getElementById("a2").innerHTML = 0;
        document.getElementById("a3").innerHTML = 0;
        document.getElementById("a4").innerHTML = 0;
        document.getElementById("a5").innerHTML = 0;
        document.getElementById("a6").innerHTML = 0;
        document.getElementById("a7").innerHTML = 0;
        document.getElementById("a8").innerHTML = 0;
        document.getElementById("g1").innerHTML = 0;
        document.getElementById("g2").innerHTML = 0;
        document.getElementById("g3").innerHTML = 0;
        document.getElementById("g4").innerHTML = 0;
        document.getElementById("g5").innerHTML = 0;
        document.getElementById("g6").innerHTML = 0;
        document.getElementById("g7").innerHTML = 0;
        document.getElementById("g8").innerHTML = 0;
	document.getElementById("temp").innerHTML = 0;
	document.getElementById("sd").innerHTML = 0;
	document.getElementById("date").innerHTML = 0;
        document.getElementById("moget").innerHTML = 0;
	document.getElementById("mtget").innerHTML = 0;
        document.getElementById("imei").innerHTML = 0;
	document.getElementById("gpio_go").onclick = function() {gpio_action()};
	document.getElementById("sat_go").onclick = function() {sat_action()};
	document.getElementById("adc_go").onclick = function() {adc_action()};
	document.getElementById("time_go").onclick = function() {time_action()};
	document.getElementById("reboot").onclick = function() {reboot_action()};
	document.getElementById("shutdown").onclick = function() {shutdown_action()};
	var ticks = 0;

        $(window).scroll(function(event){
            didScroll = true;
        });

        setInterval(function() {
            if (didScroll) {
                hasScrolled();
                didScroll = false;
            }
        }, 250);

	setInterval(function() {update_state();}, 250);


	function reboot_action(){
	    var r = confirm("Reset Box?");
            if (r == true) {
                var txt = "You pressed OK!";
            }
            else {
                return;
            }
            var http = new XMLHttpRequest();
            http.open("POST", url, true);
            http.setRequestHeader("Content-Type", "application/json");
            var data = JSON.stringify({"parameter": "reset", "value": 0});
            http.onload = function () {
              if(http.status == 200)
                alert("OK: command sent");
            };
            http.send(data);
	}

	
	function shutdown_action(){
	    var r = confirm("Poweroff Box?");
            if (r == true) {
                var r2 = confirm("This is a risky operation. Are you sure?");
                if(r2 == true) {
                  var txt = "You pressed OK!";
                }
                else {
                  return;
                }
            }
            else {
                return;
            }
	    var http = new XMLHttpRequest();
            http.open("POST", url, true);
            http.setRequestHeader("Content-Type", "application/json");
            var data = JSON.stringify({"parameter": "shutdown", "value": 0});
            http.onload = function () {
              if(http.status == 200)
                alert("OK: command sent");
            };
            http.send(data);
	}


	function gpio_action(){
	    var gpio = "D" + document.getElementById("gpioo").value;
	    var value = document.getElementById("status").value;
            var http = new XMLHttpRequest();
            http.open("POST", url, true);
            http.setRequestHeader("Content-Type", "application/json");
            var data = JSON.stringify({"parameter": gpio, "value": value});
            http.onload = function () {
              if(http.status == 200)
                alert("OK: command sent");
              else
                alert(http.status);
            };
            http.onerror = function() { alert('ERROR: no server response'); };
            http.send(data);
	}

	function sat_action(){
	    var momt = document.getElementById("momt").value;

            var value = document.getElementById("time").value;
            var http = new XMLHttpRequest();
            http.open("POST", url, true);
            http.setRequestHeader("Content-Type", "application/json");
            var data = JSON.stringify({"parameter": momt, "value": value});
            http.onload = function () {
              if(http.status == 200)
                alert("OK: command sent");
              else
                alert(http.status);
            };
            http.onerror = function() { alert('ERROR: no server response'); };
            http.send(data);
        }

	function adc_action(){
            var value = parseFloat(document.getElementById("vadc").value);
            var http = new XMLHttpRequest();
            http.open("POST", url, true);
            http.setRequestHeader("Content-Type", "application/json");
            var data = JSON.stringify({"parameter": "MUL", "value": value});
            http.onload = function () {
              if(http.status == 200)
                alert("OK: command sent");
              else
                alert(http.status);
            };
            http.onerror = function() { alert('ERROR: no server response'); };
            http.send(data);
        }

	function time_action(){
	    var value = document.getElementById("systime").value;
            var http = new XMLHttpRequest();
            http.open("POST", url, true);
            http.setRequestHeader("Content-Type", "application/json");
            var data = JSON.stringify({"parameter": "SYNCHTIME", "value": value});
            http.onload = function () {
              if(http.status == 200)
                alert("OK: command sent");
              else
                alert(http.status);
            };
            http.onerror = function() { alert('ERROR: no server response'); };
            http.send(data);
        }

	function update_state() {
	    var xmlHttp = new XMLHttpRequest();
	    xmlHttp.onreadystatechange = function () {
		if (xmlHttp.readyState == 4 && xmlHttp.status == 200) {

		    document.getElementById("boxstate").style.backgroundColor = "green";
		    ticks = 0;
		    var resp = xmlHttp.responseText;
                    var json = JSON.parse(resp);

		    var statusIridium = json.status_iridium;
                    var statusADC = json.ADC;
                    var statusGPIO = json.GPIO;
                    var sMO = json.MO;
		    var sMT = json.MT;
                    var imei = json.IMEI;
		    var temp = json.CPU;
		    var sd = json.DFS;
		    var date = json.date;
		    var mul = json.xA;
                    var adc1 = json.A1;
                    var adc2 = json.A2;
                    var adc3 = json.A3;
                    var adc4 = json.A4;
                    var adc5 = json.A5;
                    var adc6 = json.A6;
                    var adc7 = json.A7;
                    var adc8 = json.A8;
                    var gpio1 = json.D1;
                    var gpio2 = json.D2;
                    var gpio3 = json.D3;
                    var gpio4 = json.D4;
                    var gpio5 = json.D5;
                    var gpio6 = json.D6;
                    var gpio7 = json.D7;
                    var gpio8 = json.D8;

		    if(statusIridium == "1"){
                        document.getElementById("irstate").style.backgroundColor = "green";
		    }
                    else if(statusIridium == "0")
                        document.getElementById("irstate").style.backgroundColor = "red";
                    else
                        document.getElementById("irstate").style.backgroundColor = "gray";

                    if(statusADC == "1")
                        document.getElementById("adcstate").style.backgroundColor = "green";
                    else if(statusADC == "0")
                        document.getElementById("adcstate").style.backgroundColor = "red";
                    else
                        document.getElementById("adcstate").style.backgroundColor = "gray";

                    if(statusGPIO == "1")
                        document.getElementById("gpiostate").style.backgroundColor = "green";
                    else if(statusADC == "0")
                        document.getElementById("gpiostate").style.backgroundColor = "red";
                    else
                        document.getElementById("gpiostate").style.backgroundColor = "gray";

		    document.getElementById("m").innerHTML = mul;
		    document.getElementById("a1").innerHTML = adc1;
                    document.getElementById("a2").innerHTML = adc2;
                    document.getElementById("a3").innerHTML = adc3;
                    document.getElementById("a4").innerHTML = adc4;
                    document.getElementById("a5").innerHTML = adc5;
                    document.getElementById("a6").innerHTML = adc6;
                    document.getElementById("a7").innerHTML = adc7;
                    document.getElementById("a8").innerHTML = adc8;
                    document.getElementById("g1").innerHTML = gpio1;
                    document.getElementById("g2").innerHTML = gpio2;
                    document.getElementById("g3").innerHTML = gpio3;
                    document.getElementById("g4").innerHTML = gpio4;
                    document.getElementById("g5").innerHTML = gpio5;
                    document.getElementById("g6").innerHTML = gpio6;
                    document.getElementById("g7").innerHTML = gpio7;
                    document.getElementById("g8").innerHTML = gpio8;
		    document.getElementById("temp").innerHTML = temp;
		    document.getElementById("sd").innerHTML = sd;
		    document.getElementById("date").innerHTML = date;
                    document.getElementById("moget").innerHTML = sMO;
		    document.getElementById("mtget").innerHTML = sMT;
                    document.getElementById("imei").innerHTML = imei;
		}
		else {

		    ticks ++;
		    if (ticks <= 20)
			return;

		    document.getElementById("boxstate").style.backgroundColor = "gray";
		    document.getElementById("irstate").style.backgroundColor = "gray";
                    document.getElementById("adcstate").style.backgroundColor = "gray";
                    document.getElementById("gpiostate").style.backgroundColor = "gray";

		    document.getElementById("m").innerHTML = "1";
                    document.getElementById("a1").innerHTML = "0";
                    document.getElementById("a2").innerHTML = "0";
                    document.getElementById("a3").innerHTML = "0";
                    document.getElementById("a4").innerHTML = "0";
                    document.getElementById("a5").innerHTML = "0";
                    document.getElementById("a6").innerHTML = "0";
                    document.getElementById("a7").innerHTML = "0";
                    document.getElementById("a8").innerHTML = "0";
                    document.getElementById("g1").innerHTML = "0";
                    document.getElementById("g2").innerHTML = "0";
                    document.getElementById("g3").innerHTML = "0";
                    document.getElementById("g4").innerHTML = "0";
                    document.getElementById("g5").innerHTML = "0";
                    document.getElementById("g6").innerHTML = "0";
                    document.getElementById("g7").innerHTML = "0";
                    document.getElementById("g8").innerHTML = "0";
		    document.getElementById("temp").innerHTML = "0";
                    document.getElementById("sd").innerHTML = "0";
		    document.getElementById("date").innerHTML = "0";
                    document.getElementById("moget").innerHTML = "0";
		    document.getElementById("mtget").innerHTML = "0";

		}
	    }
	    xmlHttp.open("GET", url, true);
            xmlHttp.send(null);

	}

        function hasScrolled() {
            var st = $(this).scrollTop();
            
            // Make sure they scroll more than delta
            if(Math.abs(lastScrollTop - st) <= delta)
                return;
            
            // If they scrolled down and are past the navbar, add class .nav-up.
            // This is necessary so you never see what is "behind" the navbar.
            if (st > lastScrollTop && st > navbarHeight){
                // Scroll Down
                $('header').removeClass('nav-down').addClass('nav-up');
            } else {
                // Scroll Up
                if(st + $(window).height() < $(document).height()) {
                    $('header').removeClass('nav-up').addClass('nav-down');
                }
            }
            
            lastScrollTop = st;
        }
    </script>


</body>
</html>
